<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>计算机网络 | Melodyの博客</title><meta name="author" content="Melody"><meta name="copyright" content="Melody"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="计算机网络第一章、概述 端系统通过通信链路和分组交换机连接在一起  OSI       协议的基本要素：语法、语义和同步  语法：报文格式 语义：各字段的含义 同步：报文传输的先后顺序   最著名的分组交换机：  路由器 链路层交换机   端系统通过因特网服务提供商（Internet Server Provider,ISP）接入因特网，较低的ISP通过国家的国际的较高的ISP互联  网络边缘：">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机网络">
<meta property="og:url" content="https://for-melody.github.io/2022/12/15/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/index.html">
<meta property="og:site_name" content="Melodyの博客">
<meta property="og:description" content="计算机网络第一章、概述 端系统通过通信链路和分组交换机连接在一起  OSI       协议的基本要素：语法、语义和同步  语法：报文格式 语义：各字段的含义 同步：报文传输的先后顺序   最著名的分组交换机：  路由器 链路层交换机   端系统通过因特网服务提供商（Internet Server Provider,ISP）接入因特网，较低的ISP通过国家的国际的较高的ISP互联  网络边缘：">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pictrue-bed.pages.dev/img/a78c8de3a671c5b31eff23ef4087b211.jpg">
<meta property="article:published_time" content="2022-12-15T11:00:00.000Z">
<meta property="article:modified_time" content="2022-12-15T10:58:29.328Z">
<meta property="article:author" content="Melody">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pictrue-bed.pages.dev/img/a78c8de3a671c5b31eff23ef4087b211.jpg"><link rel="shortcut icon" href="https://pictrue-bed.pages.dev/img/雪人.png"><link rel="canonical" href="https://for-melody.github.io/2022/12/15/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '计算机网络',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-12-15 18:58:29'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://pictrue-bed.pages.dev/img/102548934_p0_master1200.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://pictrue-bed.pages.dev/img/a78c8de3a671c5b31eff23ef4087b211.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Melodyの博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">计算机网络</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-12-15T11:00:00.000Z" title="发表于 2022-12-15 19:00:00">2022-12-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-12-15T10:58:29.328Z" title="更新于 2022-12-15 18:58:29">2022-12-15</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">16k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>50分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="计算机网络"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="计算机网络"><a href="#计算机网络" class="headerlink" title="计算机网络"></a>计算机网络</h1><h2 id="第一章、概述"><a href="#第一章、概述" class="headerlink" title="第一章、概述"></a>第一章、概述</h2><ol>
<li><p>端系统通过<strong>通信链路</strong>和<strong>分组交换机</strong>连接在一起</p>
</li>
<li><p><font color ="red">OSI</font></p>
<img src="https://guide-blog-images.oss-cn-shenzhen.aliyuncs.com/github/javaguide/cs-basics/network/osi-7-model.png" style="zoom: 80%;" />

<img src="https://guide-blog-images.oss-cn-shenzhen.aliyuncs.com/github/javaguide/cs-basics/network/osi-model-detail.png" style="zoom:67%;" />


</li>
<li><p><strong>协议的基本要素：语法、语义和同步</strong></p>
<ol>
<li>语法：报文格式</li>
<li>语义：各字段的含义</li>
<li>同步：报文传输的先后顺序</li>
</ol>
</li>
<li><p>最著名的分组交换机：</p>
<ul>
<li>路由器</li>
<li>链路层交换机</li>
</ul>
</li>
<li><p>端系统通过因特网服务提供商（Internet Server Provider,ISP）接入因特网，较低的ISP通过国家的国际的较高的ISP互联</p>
</li>
<li><p>网络边缘：</p>
<ul>
<li>通常把与因特网相连的计算机和其他设备称为端系统，因它们位于因特网边缘所以被称为<strong>端系统</strong></li>
<li>端系统也称为主机（host）</li>
<li>主机可划分为：<strong>客户（client）和服务器（server）</strong></li>
<li>接入网：将端系统物理连接到其边缘路由器（edge router）的网络，边缘路由器是端系统到任何其他远程端系统的路径上的第一台路由器</li>
</ul>
</li>
<li><p>网络核心：</p>
<ul>
<li><p><font color ="orange"><strong>分组交换:</strong></font></p>
<ol>
<li>**存储转发:**在交换机能够开始向输出链路传输该分组的第一个比特之前，必须接受到整个分组</li>
<li>特点：（1）报文分组，加首部（2）经路由器储存转发（3）在目的地合并</li>
</ol>
</li>
<li><p><font color ="orange"><strong>电路交换：</strong></font></p>
<ol>
<li><strong>频分复用（FDM）</strong></li>
<li><strong>时分复用(TDM)</strong></li>
<li>特点：建立电路连接、通话、拆除连接</li>
</ol>
</li>
<li><p>排队时延和分组丢失（丢包）</p>
</li>
<li><p>ISP互联：</p>
<p><img src="https://img-blog.csdnimg.cn/20190816150131417.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3NDI0MjAz,size_16,color_FFFFFF,t_70"></p>
</li>
</ul>
</li>
<li><p>时延，丢包和吞吐量</p>
<ul>
<li>**节点处理时延 $d_{proc}$**（P25）</li>
<li><strong>排队时延 $d_{queue}$</strong></li>
<li><strong>传输时延 $d_{trans}$</strong></li>
<li><strong>传播时延 $d_{prop}$</strong></li>
<li>传输时延是由路由器推出分组所需要的时间，与<strong>路由器距离无关</strong>；传播时延是一比特从一台路由器传播到另一台路由器所需要的时间，与<strong>分组长度或链路传输速率无关</strong></li>
<li>总时延：$d_{nodal}&#x3D;d_{proc}+d_{queue}+d_{trans}+d_{prop}$</li>
</ul>
</li>
<li><p>瞬时吞吐量是在任何时间主机接收到文件的速率</p>
</li>
<li><p>协议分层：各层的所有协议被称为协议栈</p>
<ul>
<li><p><strong>应用层</strong>：是网络应用程序及它们的应用层协议存留的地方。包含HTTP,SMTP,FTP,DNS</p>
</li>
<li><p><strong>运输层</strong>：因特网的运输层在应用程序断电之间传送应用层报文，运输层的分组称为<strong>报文段</strong>（segment）</p>
</li>
<li><p><strong>网络层</strong>：负责将称为<strong>数据报</strong>（datagram）的网络层分组从一台主机移动到另一台主机。包含TCP,UDP，IP</p>
</li>
<li><p><strong>链路层</strong>：网络层将数据报下传给链路层，链路层沿着路径将数据报出传递给下一个节点。链路层分组称为<strong>帧</strong>（frame）</p>
</li>
<li><p><strong>物理层</strong>：物理层的任务是将该帧中的<strong>一个个比特</strong>从一个节点移动到下一个节点。该层中的协议是链路相关的并且进一步与该链路的实际传输媒体相关</p>
</li>
</ul>
</li>
<li><p>增加控制信息:构造协议数据单元 (PDU)</p>
</li>
<li><p>控制信息主要包括: </p>
</li>
<li><p>地址（Address）: 标识发送端&#x2F;接收端 </p>
</li>
<li><p>差错检测编码（Error-detecting code）: 用于差错检测或纠正 </p>
</li>
<li><p>协议控制（Protocol control）: 实现协议功能的附加信息，如: 优先级（priority）、服务质量（QoS） 和安全控制等 </p>
</li>
<li><p><strong>OSI模型（7层）:应用层、表示层、会话层、传输层、网络层、数据链路层、物理层</strong></p>
</li>
</ol>
<h2 id="第二章、应用层"><a href="#第二章、应用层" class="headerlink" title="第二章、应用层"></a>第二章、应用层</h2><h3 id="2-1、应用层协议原理"><a href="#2-1、应用层协议原理" class="headerlink" title="2.1、应用层协议原理"></a>2.1、应用层协议原理</h3><ol>
<li>应用程序体系结构：<ol>
<li>客户-服务器体系结构（client-server architecture）<ul>
<li>有一个总是打开的主机称为<strong>服务器</strong>，它服务于来自其他称为<strong>客户</strong>的主机的请求</li>
<li>客户之间不直接通信</li>
</ul>
</li>
<li>P2P体系结构<ul>
<li>应用程序在间断连接的主机之间使用直接通信，这些主机被称为<strong>对等方</strong></li>
<li>自扩展性（书P57）</li>
</ul>
</li>
</ol>
</li>
<li>进程通信：<ol>
<li>发起通信的进程标识为<strong>客户</strong>，会话开始时等待联系的进程是<strong>服务器</strong></li>
<li>进程寻址：通过IP（<strong>32比特</strong>），目的地端口号实现</li>
</ol>
</li>
<li>TCP：<ol>
<li>面向连接的服务<ul>
<li>连接是全双工的，即连接双方的进程可以在此连接上同时进行报文收发</li>
</ul>
</li>
<li>可靠的数据传输服务</li>
<li><strong>面向连接、可靠数据传输、流量控制、拥塞控制；无时延和带宽保证</strong></li>
</ol>
</li>
<li>UDP：<ol>
<li>UDP是一种不提供不必要服务的轻量级运输协议，它仅提供最小服务</li>
<li>UDP无连接</li>
<li>提供不可靠数据传送服务</li>
<li><strong>不提供建立连接，可靠性，流量控制，拥塞控制；时延和带宽保证</strong></li>
</ol>
</li>
<li>应用层协议定义了运行在不同端系统上的应用程序进程如何相互传递报文</li>
</ol>
<h3 id="2-2、Web和HTTP"><a href="#2-2、Web和HTTP" class="headerlink" title="2.2、Web和HTTP"></a>2.2、Web和HTTP</h3><ol>
<li><p>HTTP概况</p>
<ol>
<li><p>Web的应用层协议是超文本传输协议HTTP</p>
</li>
<li><p>Web页面（Web page）（也叫文档）是由<strong>对象</strong>组成的。一个对象只是一个文件</p>
</li>
<li><p>多数Web页面含有一个HTML基本文件以及几个引用对象</p>
</li>
<li><p>HTTP使用TCP</p>
</li>
<li><p>HTTP服务器不保存关于客户的任何信息，是一个无状态协议（stateless protocol）</p>
</li>
</ol>
</li>
<li><p>持续连接：每个请求&#x2F;响应经一个单独的TCP连接发送</p>
</li>
<li><p>非持续连接：所有请求&#x2F;响应经相同的TCP连接发送</p>
</li>
<li><p><strong>往返时间（Round-Tip Time，RTT）</strong>指一个短分组从客户到服务器然后再返回客户所花费的时间</p>
</li>
<li><p>HTTP报文格式：</p>
<ol>
<li><p>HTTP请求报文request：</p>
<ul>
<li>第一行为请求行，后继的行叫做首部行</li>
</ul>
</li>
</ol>
<ul>
<li><p>请求行：</p>
<ol>
<li>有三个字段：方法字段，URL字段，HTTP版本字段</li>
<li>方法字段：GET,POST,HEAD,PUT,DELETE</li>
</ol>
<ul>
<li><p>首部行：</p>
<ol>
<li><p>Host指明了对象所在的主机</p>
</li>
<li><p>Connection：close 浏览器告诉服务器在发送完请求对象后关闭连接（close为非持续连接）</p>
</li>
<li><p>User-agent 指明用户代理，即向服务器发送请求的浏览器类型</p>
</li>
<li><p>Accept 表示用户想得到该对象的语法版本</p>
</li>
</ol>
</li>
</ul>
<ol start="5">
<li>请求报文通用格式：</li>
</ol>
<p> 使用GET方法实体体为空，POST方法才使用实体体，其中包含用户在表单字段中的输入值</p>
<p> 使用GET方法，表单(各字段)输入值被上载,以URL请求行的字段: <a target="_blank" rel="noopener" href="http://www.somesite.com/animalsearch?monkeys&banana">www.somesite.com/animalsearch?monkeys&amp;banana</a></p>
<ul>
<li>当服务器收到一个HEAD方法方法的请求时，将会用一个HTTP报文响应但不返回请求对象</li>
</ul>
</li>
<li><p>PUT方法允许用户上传对象到指定的Web服务器上的指定路径</p>
<ul>
<li>DELETE方法允许用户删除Web服务器上的对象</li>
</ul>
</li>
</ul>
<ol start="2">
<li><p>HTTP响应报文response：</p>
<ul>
<li><p>分为1个初始状态行，6个首部行然后是实体体（entity body）</p>
</li>
<li><p>实体体部分是报文的主要部分，它包含了所请求对象本身</p>
</li>
<li><p>状态行有3个字段：协议版本字段、状态码和相应状态信息</p>
</li>
<li><p>首部行：</p>
<ol>
<li>Connection：close代表发送完报文后关闭该TCP连接</li>
</ol>
</li>
</ul>
</li>
<li><p>Date指示服务器产生并发送该相应报文的日期和时间</p>
<ol start="3">
<li>Server指示该报文是由什么服务器产生的</li>
<li>Last 指示对象创建或最后修改的日期和时间</li>
<li>Content-Length指示了被发送对象中的字节数</li>
<li>Content-Type指示实体体汇总的对象是HTML文本</li>
</ol>
</li>
</ol>
<ul>
<li><p>响应报文通用格式：</p>
</li>
<li><p>常用状态码及相关短语：</p>
</li>
</ul>
</li>
<li><p>cookie:</p>
<ol>
<li>允许站点对用户进行跟踪</li>
</ol>
</li>
<li><p>Web缓存：</p>
<ol>
<li>也叫代理服务器</li>
<li>目标:在不访问服务器的前提下满足客户端的HTTP请求</li>
<li>缓存既充当客户端，也充当服务器</li>
<li>一般由ISP(Internet服务提供商)架设</li>
<li>为什么需要Web缓存器?<ul>
<li>减少对客户机请求的响应时间</li>
<li>减少内部网络与接入链路上的通信量</li>
<li>能从整体上大大降低因特网上的Web流量</li>
</ul>
</li>
</ol>
</li>
<li><p>条件GET方法：</p>
<ol>
<li>目的:证实缓存器中的对象是否为最新</li>
<li>缓存器：在请求报文中包含对象最后修改时间 If-modified-since: date</li>
<li>服务器: 如果对象是最新的则响应报文中不包含对象且状态行为 HTTP&#x2F;1.0 304 Not Modified</li>
</ol>
</li>
</ol>
<h3 id="2-3、电子邮件"><a href="#2-3、电子邮件" class="headerlink" title="2.3、电子邮件"></a>2.3、电子邮件</h3><ol>
<li><p>三个组成部分：用户代理user agents，邮件服务器mail servers，简单邮件传送协议（SMTP）和邮件接收协议</p>
</li>
<li><p>客户使用TCP来可靠传输邮件消息到服务器端口号25</p>
</li>
<li><p>SMTP：</p>
<ol>
<li>用于从发送方的邮件服务器发送报文到接收方的邮件服务器</li>
<li>直接传送: 发送服务器到接收服务器</li>
<li>命令: ASCII文本格式</li>
<li>应答: 状态码及其短语</li>
<li>邮件消息(header &amp; body)必须是7-bit ASCII</li>
<li>SMTP使用持久连接</li>
<li>SMTP服务器使用CRLF.CRLF 来判断邮件消息的结束</li>
<li>传输的3个阶段：握手 (问候)，邮件消息的传输，结束</li>
</ol>
</li>
<li><p>SMTP和HTTP对比：</p>
<ol>
<li>HTTP：拉协议（用户使用HTTP从该服务器拉取这些信息）,SMTP：推协议（发送邮件服务器把文件推向接收服务器）</li>
<li>都有ASCII 命令&#x2F;应答交互, 状态码</li>
<li>HTTP: 每个对象封装在它各自的HTTP响应消息中发送</li>
<li>SMTP: 把所有报文对象放在一个报文中</li>
</ol>
</li>
<li><p>邮件消息的格式：</p>
<ol>
<li>每个首部行必须包含一个From首部行和一个To首部行，一个首部也许包含一个Subject首部行及其他可选首部行</li>
</ol>
</li>
<li><p>MIME: Multipurpose Internet mail Extensions多用途因特网邮件扩展, RFC 2045, 2046，增添额外的信头头部声明MIME content-type</p>
</li>
<li><p>邮件访问协议：</p>
<ol>
<li>因SMTP是推协议，而用户代理从邮件服务器中取得报文是拉动作，所以不能用SMTP</li>
<li>POP3<ul>
<li>身份认证 (代理 &lt;–&gt;服务器) 并下载邮件消息</li>
<li>使用TCP连接</li>
</ul>
</li>
<li>IMAP<ul>
<li>允许用户像对待本地邮箱那样操纵远程邮箱的邮件</li>
<li>所有邮件消息保存在一个位置: 服务器</li>
<li>允许用户利用文件夹组织管理邮件消息</li>
<li>允许用户代理获取报文某些部分的命令</li>
</ul>
</li>
<li>HTTP：<ul>
<li>在邮件服务器之间接收和发送邮件仍使用SMTP，但其他两个地方使用HTTP</li>
</ul>
</li>
</ol>
</li>
</ol>
<h3 id="2-4、DNS"><a href="#2-4、DNS" class="headerlink" title="2.4、DNS"></a>2.4、DNS</h3><ol>
<li><p><strong>功能：</strong></p>
<ol>
<li>主机名到IP地址的转换</li>
<li>主机别名：一个主机可以有一个规范主机名和多个主机别名</li>
<li>邮件服务器别名</li>
<li>负载分配：<ul>
<li>DNS实现冗余服务器：一个IP地址集合可以对应于同一个规范主机名</li>
</ul>
</li>
</ol>
</li>
<li><p>DNS协议运行在UDP上，使用53号端口</p>
</li>
<li><p>DNS特点分布式数据库：</p>
<ol>
<li>一个由分层DNS服务器实现的分布式数据库</li>
<li>应用层协议：DNS服务器实现域名转换 (域名&#x2F;地址转换)</li>
</ol>
</li>
<li><p>分布式、层次数据库：</p>
</li>
<li><p>根DNS服务器，顶级域（Top-Level Domain，TLD）DNS服务器，权威DNS服务器</p>
</li>
<li><p>本地DNS服务器：</p>
<ol>
<li>严格来说不属于该服务器的层次结构</li>
<li>每个ISP（如居民区ISP、公司、大学）都有一个本地DNS，也叫默认服务器</li>
<li>主机发出DNS请求时，该请求被发往本地DNS服务器。起着代理的作用，转发请求到层次结构中</li>
</ol>
</li>
<li><p>DNS查询方法：</p>
<ol>
<li>递归查询<ul>
<li>名字解析的负担交给被查询的名字服务器</li>
</ul>
</li>
<li>迭代查询</li>
<li>任何DNS查询可以既是递归的也是迭代的</li>
<li>实践中通常为从请求主机到本地DNS服务器的查询是递归的，其余查询是迭代的</li>
</ol>
</li>
<li><p>DNS记录：</p>
<ol>
<li><p>DNS: 存储资源记录(RR，Resource Records)的分布式数据库，RR提供了主机名到ip地址的映射</p>
</li>
<li><p>资源记录（Resource Records，RR）书P89</p>
<ul>
<li>格式: (name, value, type,ttl)</li>
<li>ttl是该记录的生存时间，它决定了资源记录应当从缓存中删除的时间</li>
<li>Name和Value的值取决于Type</li>
<li>Type&#x3D;A（Address），name &#x3D; 主机名，value &#x3D; IP地址（A类型的RR提供了标准主机名到ip地址的映射）</li>
<li>Type&#x3D;NS（ name server ），name &#x3D; 域名（如foo.com）， value &#x3D; 该域权威名字服务器的主机名（这个RR用于沿着查询链来路由DNS查询）</li>
<li>Type&#x3D;CNAME（canonical），name &#x3D; 主机别名 （如 <a target="_blank" rel="noopener" href="http://www.ibm.com的真名为servereast.backup2.ibm.com)/">www.ibm.com的真名为servereast.backup2.ibm.com）</a> ，value &#x3D; 真实的规范主机名</li>
<li>Type&#x3D;MX（mail exchange），name &#x3D;邮件服务器的主机别名，value &#x3D;邮件服务器的真实规范主机名</li>
</ul>
</li>
<li><p>如果一台DNS服务器是用于某特定主机名的权威DNS服务器，那么该DNS服务器会有一条包含用于该主机名的类型A记录（即使该DNS服务器不是其权威DNS服务器，它也可能在缓存中包含有一条类型A记录)</p>
</li>
<li><p>如果服务器不是用于某主机名的权威服务器,那么该服务器将包含一条类型NS记录，该记录对应于包含主机名的域;它还将包括一条类型A记录，该记录提供了在NS记录的Value字段中的 DNS服务器的IP地址</p>
</li>
</ol>
</li>
<li><p>DNS报文：</p>
<ol>
<li><p>DNS只有查询和回答报文，且具有相同格式</p>
</li>
<li><p>前12字节是首部区域</p>
<ul>
<li>标识符: 16位，查询和应答报文使用相同的标识符</li>
<li>标志:有若干个标志构成，分别标识不同的功能</li>
<li>问题区域包含正在进行的查询信息，包含名字字段和类型字段</li>
</ul>
</li>
</ol>
</li>
<li><p><strong>在DNS数据库中插入记录</strong></p>
</li>
<li><p>内容分发网络(Content distribution networks, CDN)：主要是截获和重定向请求</p>
</li>
</ol>
<h2 id="第三章、运输层"><a href="#第三章、运输层" class="headerlink" title="第三章、运输层"></a>第三章、运输层</h2><h3 id="3-1、多路分解与多路复用"><a href="#3-1、多路分解与多路复用" class="headerlink" title="3.1、多路分解与多路复用"></a>3.1、多路分解与多路复用</h3><ol>
<li><p>在接收主机多路分解:将接收到的数据段传递到正确的套接字</p>
</li>
<li><p>在发送主机多路复用:从多个套接字收集数据, 用首部封装数据，然后将报文段传递到网络层</p>
</li>
<li><p>网络层:两个主机之间的逻辑通信；</p>
<p>传输层:两个进程之间的逻辑通信</p>
</li>
<li><p>端口号大小为16比特，0-1023范围的端口号称为周知端口号</p>
</li>
<li><p>无连接多路分解：</p>
<ol>
<li>UDP套接字由二元组标识（目的地IP地址, 目的地端口号）</li>
<li>具有不同的源IP地址且&#x2F;或源端口号，但具有相同的目的IP地址和目的端口号的IP报文段指向同样的套接字</li>
</ol>
</li>
<li><p><strong>面向连接的多路分解</strong>：</p>
<ol>
<li>TCP 套接字由4部分指定: （源IP地址，源端口号，目的IP地址，目的端口号）</li>
</ol>
</li>
</ol>
<h3 id="3-2、UDP"><a href="#3-2、UDP" class="headerlink" title="3.2、UDP"></a>3.2、UDP</h3><ol>
<li><p>“尽力而为”服务，UDP段可能：</p>
<p>• 丢包</p>
<p>• 对应用程序交付失序</p>
</li>
<li><p>为何要有 UDP协议? </p>
<p>• 无连接创建(它将增加时延) </p>
<p>• 简单：在发送方、接收方无连接状态</p>
<p>• 段首部小，UDP首部只有8字节，TCP有20字节</p>
<p>• 无拥塞控制: UDP能够尽可能快地传输</p>
</li>
<li><p>应用层交给 UDP 多长的报文，UDP 就照样发送，即一次发送一个报文</p>
</li>
<li><p>UDP首部格式：</p>
<ul>
<li>首部字段有 8 个字节，由 4 个字段组成，每个字段都是两个字节</li>
</ul>
</li>
<li><p>经UDP的可靠传输 : 在应用层增加可靠性</p>
<p>• 应用程序特定的差错恢复</p>
</li>
<li><p><strong>UDP校验和</strong></p>
<p>加法有溢出则进行回卷</p>
<p>在计算检验和时，临时把“伪首部”和 UDP 用户数据报连接在一起</p>
</li>
</ol>
<h3 id="3-3、可靠数据传输协议"><a href="#3-3、可靠数据传输协议" class="headerlink" title="3.3、可靠数据传输协议"></a>3.3、可靠数据传输协议</h3><ol>
<li><p>rdt1.0</p>
</li>
<li><p>rdt2.0</p>
<ul>
<li>停等协议：发送方发送一个报文，然后等待接受方的响应，在等待时不能从上层获得更多的数据</li>
</ul>
</li>
<li><p>rdt2.1</p>
<ul>
<li><p>处理冗余: </p>
<p>• 发送方对每个分组增加<em>序列号</em></p>
<p>• 如果ACK&#x2F;NAK受损，发送方重传当前的分组</p>
<p>• 接收方丢弃(不再向上交付)冗余分组</p>
</li>
</ul>
</li>
<li><p>rdt2.2：一个不要NAK的协议</p>
<ul>
<li><p>同 rdt2.1一样的功能, 只用 ACKs </p>
</li>
<li><p>代替NAK,接收方对最后正确接收的分组发送ACK</p>
<p>•  接收方必须明确包含被确认的报文的序号</p>
</li>
<li><p>发送方收到重复 ACK 将导致和 NAK一样的处理: 重发当前报文</p>
</li>
</ul>
</li>
<li><p>rdt3.0：具有出错和丢失的信道</p>
<ul>
<li><p>发送方等待ACK一段“合理的”时间</p>
<p>• 如在这段时间没有收到ACK则重传</p>
<p>• 如果分组(或ACK)只是延迟(没有丢失)： </p>
<p>​     重传将是冗余的，但序号的使用已经处理了该情况；</p>
<p>​     接收方必须定义被确认的分组序号</p>
<p>• 需要倒计时定时器</p>
</li>
</ul>
</li>
<li><p>流水线可靠数据传输协议：</p>
<ul>
<li><p>流水线: 发送方允许发送多个 “在路上的”, 还没有确认的报文</p>
<p>• 序号数目的范围必须增加</p>
<p>• 在发送方&#x2F;接收方必须有缓冲区</p>
</li>
</ul>
</li>
<li><p>解决流水线的差错恢复的两种基本方法：回退N步（Go-Back-N,GBN）和选择重传（Selective Repeat,SR）</p>
</li>
<li><p><strong>回退N步：</strong></p>
<ol>
<li><p>又称为滑动窗口协议</p>
</li>
<li><p>发送方：</p>
<ul>
<li><p>ACK(n): 确认所有的（包括序号n）的分组 - “累计ACK”（可能收到重复的ack）</p>
</li>
<li><p>对每个传输中的分组的用同一个计时器</p>
<p>对第一个发送未被确认的报文定时</p>
</li>
<li><p>timeout(n):若超时，重传窗口中的分组n及所有更高序号的分组</p>
</li>
</ul>
</li>
<li><p>接收方：</p>
<ul>
<li><p>对失序的分组: </p>
<p>• 丢弃 (不缓存) -&gt; 没有接收缓冲区! </p>
<p>• 重新确认具有按序的分组</p>
</li>
<li><p>只有ACK: 对接收的分组总是发送具有最高按序序号的ACK</p>
</li>
</ul>
</li>
</ol>
</li>
<li><p><strong>选择重传：</strong></p>
<ol>
<li>接收方分别确认已经收到的分组，必要时，缓冲报文, 最后按序提交给上层</li>
<li>发送者只重发没有收到确认的分组对每个没有确认的报文发送者都要启动一个定时器(每个未被确认的报文都有一个定时器) </li>
<li>窗口长度必须小于或等于序号空间大小的一半</li>
</ol>
</li>
</ol>
<h3 id="3-4、TCP"><a href="#3-4、TCP" class="headerlink" title="3.4、TCP"></a>3.4、TCP</h3><ol>
<li><p>概述：</p>
<ol>
<li><p>**点到点: **一个发送方, 一个接收方</p>
</li>
<li><p><strong>面向连接:</strong> </p>
<p>• 在进行数据交换前，初始化发送方与接收方状态，进行握手(交换控制信息)。 </p>
<p>• 连接状态与端系统有关，不为路由器所知</p>
</li>
<li><p><strong>全双工数据:</strong> </p>
<p>• 同一连接上的双向数据流</p>
</li>
<li><p>TCP采用<strong>累计确认</strong></p>
</li>
</ol>
</li>
<li><p><strong>发送和接收缓冲区</strong></p>
</li>
<li><p>MSS: 最大报文段长度，通常根据最初确定的由本地发送主机发送的最大链路层帧（最大传输单元，MTU）长度来设置</p>
</li>
<li><p>设置MSS要保证一个TCP报文段加TCP&#x2F;IP首部长度（通常40字节）将适合单个链路层帧</p>
</li>
<li><p>MSS指在<strong>报文段里应用层数据的最大长度，而不包括首部的TCP报文段的长度</strong></p>
</li>
<li><p>TCP面向流的概念：</p>
<ol>
<li>**可靠、有序的字节流:**没有 “报文边界”</li>
<li><strong>流水线:</strong> TCP拥塞和流量控制设置滑动窗口协议</li>
<li><strong>流量控制:</strong> 发送方不能淹没接收方</li>
<li><strong>拥塞控制:</strong> 抑止发送方速率来防止过分占用网络资源</li>
</ol>
</li>
<li><p><strong>TCP报文段结构：</strong></p>
<ol>
<li><p>TCP首部一般为<strong>20字节</strong>（选项字段为空）：</p>
<ol>
<li><p><strong>源端口和目的端口字段——各占 2 字节</strong></p>
<ul>
<li>端口是运输层与应用层的服务接口。运输层的复用和分解功能都要通过端口才能实现</li>
</ul>
</li>
<li><p><strong>序号字段——占 4 字节</strong></p>
<ul>
<li><p>TCP 连接中传送的数据流中的<strong>每一个字节都编上一个序号</strong></p>
</li>
<li><p>序号字段的值则指的是本报文段所发送的数据的<strong>第一个字节的序号</strong></p>
</li>
</ul>
</li>
<li><p><strong>确认号字段——占 4 字节</strong></p>
<ul>
<li>是期望收到对方的下一个报文段的数据的第一个字节的序号</li>
</ul>
</li>
<li><p>首部长度（即数据偏移）——占 4 比特</p>
<ul>
<li><p>指示了以32比特的字为单位的TCP首部长度。也就是说，它指出 TCP 报文段的数据起始处距离 TCP 报文段的起始处有多远，因TCP首部长度可变</p>
</li>
<li><p>“数据偏移”的单位是 32 位字（以 4 字节为计算单位）</p>
</li>
</ul>
</li>
<li><p>保留字段——占 6 比特</p>
<ul>
<li>保留为今后使用，但目前应置为 0</li>
</ul>
</li>
<li><p>标志字段——占6比特</p>
<ul>
<li><p>紧急 URG —— 当 URG &#x3D; 1 时，表明紧急指针字段有效。它告诉系统此报文段中有紧急数据，应尽快传送(相当于高优先级的数据)，紧急数据的最后一个字节由16比特的紧急数据指针字段指出</p>
</li>
<li><p>确认 ACK —— 只有当 ACK &#x3D; 1 时确认号字段才有效。当ACK &#x3D; 0 时，确认号无效</p>
</li>
<li><p>推送 PSH (PuSH) —— 接收 TCP 收到 PSH &#x3D; 1 的报文段，就尽快地交付接收应用进程，而不再等到整个缓存都填满了后再向上交付</p>
</li>
<li><p>复位 RST (ReSeT) —— 当 RST &#x3D; 1 时，表明 TCP 连接中出现严重差错（如由于主机崩溃或其他原因），必须释放连接，然后再重新建立运输连接</p>
</li>
<li><p>同步 SYN —— 同步 SYN &#x3D; 1 表示这是一个连接请求或连接接受报文</p>
</li>
<li><p>终止 FIN (FINis) —— 用来释放一个连接。FIN &#x3D; 1 表明此报文段的发送端的数据已发送完毕，并要求释放运输连接</p>
</li>
</ul>
</li>
<li><p>窗口字段 —— 占 2 字节</p>
<ul>
<li><p>用来让对方设置发送窗口的依据，单位为字节。</p>
</li>
<li><p>用于流量控制，用于指示作为接受方，愿意接受的字节数量</p>
</li>
</ul>
</li>
<li><p>检验和 —— 占 2 字节</p>
<ul>
<li><p>检验和字段检验的范围包括首部和数据这两部分</p>
</li>
<li><p>在计算检验和时，要在 TCP 报文段的前面加上 12 字节的伪首部</p>
</li>
</ul>
</li>
<li><p>紧急指针字段 —— 占 16 位</p>
<ul>
<li>指出紧急数据最后一个字节的位置，也就是指出在本报文段中，紧急数据共有多少个字节（紧急数据放在本报文段数据的最前面）</li>
</ul>
</li>
<li><p>选项字段——可扩展</p>
</li>
<li><p>填充字段 —— 这是为了使整个首部长度是 4 字节的整数倍</p>
</li>
</ol>
</li>
<li><p><strong>序号:</strong> 报文段中第1个数据字节在字节流中的位置编号</p>
</li>
<li><p><strong>确认号:</strong> </p>
<p>• 期望从对方收到下一个字节的序号</p>
<p>• 累积确认</p>
</li>
<li><p>问：接收方如何处理失序报文段？</p>
<p>回答：TCP规范没有说明， 由实现者自行选择实现: 抛弃&#x2F;缓存</p>
</li>
</ol>
</li>
<li><p>TCP往返时延的估计和超时：</p>
<ol>
<li><p>估计往返时间：</p>
<ul>
<li><p>样本RTT（SampleRTT）: 测量从报文段发送到收到确认的时间</p>
</li>
<li><p>TCP维持一个SampleRTT均值（称为EstimatedRTT）</p>
</li>
<li><p>一旦获得一新RTT，TCP根据指数加权平均更新EstimatedRTT, $\alpha$ 推荐值为0.125</p>
<p>$EstimatedRTT &#x3D; (1-\alpha)*EstimatedRTT+\alpha *SampleRTT$</p>
</li>
<li><p>DevRTT：RTT的偏差，用于估算SampleRTT一般会偏离EstimatedRTT的程度, $\beta$ 推荐值为0.25</p>
<p>$DevRTT&#x3D;(1-\beta)*DevRTT+\beta *|SampleRTT-EstimatedRTT|$</p>
</li>
</ul>
</li>
<li><p>设置超时：</p>
<ul>
<li><p>超时间隔应等于EstimtedRTT 加上 “安全余量”</p>
<p>EstimatedRTT变化大 -&gt; 更大的安全余量</p>
</li>
<li><p>超时间隔：$TimeoutInterval &#x3D; EstimatedRTT + 4*DevRTT$</p>
</li>
</ul>
</li>
<li><p>初始化超时：</p>
<ul>
<li><p>初始时TimeoutInterval设置为1秒</p>
</li>
<li><p>第一个样本RTT获得后， </p>
<p>$EstimatedRTT&#x3D;SampleRTT$，</p>
<p>$DevRTT&#x3D;SampleRTT&#x2F;2$，</p>
<p>$TimeoutInterval &#x3D;EstimatedRTT + max (G, K*DevRTT) $</p>
<p>（K&#x3D;4，G是用户设置的时间粒度）</p>
</li>
</ul>
</li>
</ol>
</li>
<li><p>可靠数据传输：</p>
<ol>
<li><p>TCP在IP不可靠服务的基础上创建可靠数据传输服务</p>
<p>• 肯定确认和定时器</p>
<p>• 序号、重传</p>
</li>
<li><p>TCP使用单个重传计时器</p>
</li>
<li><p>重传被下列事件触发: </p>
<p>• 超时事件</p>
<p>• 重复ACK</p>
</li>
<li><p>定时器与最早没有被确认的报文段关联</p>
</li>
<li><p><strong>超时间隔加倍</strong>：</p>
<ul>
<li>TCP每次重传，都会把下一次的超时间隔设置为先前值的两倍</li>
<li>但是当<strong>收到上层应用的数据</strong>和<strong>收到ACK</strong>两个事件中的任何一个发生时，定时器的TimeoutInterval值恢复为由近期的EstimatedRTT和DevRTT计算得到</li>
<li>这种修改，提供了一种形式受限的拥塞控制</li>
</ul>
</li>
<li><p><strong>快速重传</strong></p>
<ol>
<li><p>发送方可以在超时之前通过重复的ACK检测丢失报文段</p>
</li>
<li><p>如果发送方收到3个对同样报文段的冗余确认，则发送方认为该报文段之后的数据已经丢失。</p>
<p>• 启动快速重传: 在定时器超时之前重发丢失的报文段</p>
</li>
<li><p>冗余ACK：再次确认某个报文段的ACK</p>
</li>
</ol>
</li>
</ol>
</li>
<li><p><strong>流量控制</strong>（书P165）</p>
<ol>
<li><p>流量控制：发送方不能发送的太多太快，让接收缓冲区溢出</p>
</li>
<li><p>TCP通过让发送方维护一个接收窗口的变量来提供流量控制</p>
</li>
<li><p>发送方要限制未确认的数据不超过缓存</p>
<p>$LastByteSent-LastByteAcked &lt;&#x3D; RcvBuffer$</p>
</li>
<li><p>缓冲区的剩余空间也就是接收窗口：$rwnd&#x3D; RcvBuffer-[LastByteRcvd -LastByteRead] $</p>
</li>
<li><p>由于该空间是随时间变化的，所以rwnd也是<strong>动态的</strong></p>
</li>
<li><p>接收方在报文段接收窗口字段中通告其接收缓冲区的剩余空间</p>
</li>
<li><p>当主机B的接收窗口为0时，主机A继续发送只有一个字节数据的报文段（防止主机A被永远阻塞，书上例子很详细）</p>
</li>
</ol>
</li>
<li><p>TCP连接管理</p>
<ol>
<li><p>三次握手：</p>
<ol>
<li>步骤 1: 客户机向服务器发送 TCP SYN报文段<ul>
<li>随机指定初始序号（client_isn）放于TCP报文段首部的序号字段中</li>
<li>没有数据</li>
<li>首部SYN比特置1</li>
</ul>
</li>
<li>步骤 2: 服务器收到SYN报文段, 用SYNACK报文段回复<ul>
<li>服务器为该连接分配缓冲区和变量</li>
<li>指定服务器初始序号（server_isn）放于TCP报文段首部的序号字段中</li>
<li>首部SYN比特置1</li>
<li>首部确认号字段置client_isn+1</li>
</ul>
</li>
<li>步骤3：客户机接收到 SYNACK<ul>
<li>客户机为该连接分配缓冲区和变量</li>
<li>用ACK报文段确认回复（该客户通过将值server_isn+1放置到TCP报文段首部的确认字段中完成）</li>
<li>可能包含数据</li>
<li>SYN比特置0</li>
</ul>
</li>
</ol>
</li>
<li><p>关闭连接：</p>
<ol>
<li><p>Step 1: 客户发送 TCP FIN 控制报文段到服务器</p>
</li>
<li><p>Step 2: 服务器接收 FIN, 回复 ACK. 半关闭连接, 并发送FIN到客户</p>
</li>
<li><p>Step 3: 客户接收 FIN, 回复 ACK. </p>
<p>进入 “timed wait”状态</p>
<p>等待结束时释放连接资源</p>
</li>
<li><p>Step 4: 服务器接收 ACK. 连接关闭</p>
</li>
</ol>
</li>
<li><p>TCP状态转化：</p>
<ol>
<li><p>客户端</p>
</li>
<li><p>服务器端</p>
</li>
</ol>
</li>
</ol>
</li>
<li><p><strong>拥塞控制原理</strong></p>
<ol>
<li>拥塞: 从信息角度看: “太多源主机发送太多的数据，速度太快以至于网络来不及处理”</li>
<li>表现:<ul>
<li>丢失分组 (路由器的缓冲区溢出)</li>
<li>长延迟 (在路由器的缓冲区排队)</li>
</ul>
</li>
<li>拥塞网络的代价：<ol>
<li>当分组的到达速率接近链路容量时，分组经历巨大的排队时延</li>
<li>发送方必须执行重传以补偿因为缓存溢出而丢弃（丢失）的分组</li>
<li>发送方在遇到大时延时所进行的不必要重传会引起路由器利用其链路带宽来转发不必要的分组副本</li>
<li>当一个分组沿一条路径被丢弃时，每个上游路由器用于转发该分组到丢弃该分组而使用的传输容量最终被浪费掉了</li>
</ol>
</li>
<li>拥塞控制方法：<ol>
<li>根据网路层是否为运输层拥塞控制提供了<strong>显示帮助</strong>，来区分拥塞控制方法</li>
<li>端到端拥塞控制<ol>
<li>网路层没有为运输层提供显示的支持</li>
<li>从端系统根据观察到的时延和丢失现象推断出拥塞</li>
<li>TCP采用此方法</li>
<li>TCP报文段的丢失（超时或3次冗余确认）被认为是网络拥塞的一个迹象</li>
</ol>
</li>
<li>网络辅助的拥塞控制<ol>
<li>路由器向发送方提供关于网络中拥塞状态的显示反馈信息</li>
<li>一个bit指示一条链路出现拥塞(SNA,DECnet) </li>
<li>指示发送方按照一定速率发送（ATM）</li>
<li>两种形式发送拥塞信息<ul>
<li>直接反馈信息可以由网络路由器发给发送方。这种方式的通知通常采用了一种阻塞分组 （choke packet)的形式（主要是说:“我拥塞了!”)。</li>
<li>路由器标记或更新从发送方流向接收方的分组中的某个字段来指示拥塞的产生。一旦收到一个标记的分组后，接收方就会向发送方通知该网络拥塞指示。注意到后一种形式的通知至少要经过一个完整的往返时间。</li>
</ul>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li><p><strong>TCP拥塞控制</strong></p>
<ol>
<li><p>采用端到端控制 (没有网络辅助)</p>
</li>
<li><p>发送方通过<strong>cwnd拥塞窗口（congestion window）</strong>限制传输:LastByteSent-LastByteAcked&lt;&#x3D;min{ cwnd，rwnd}</p>
</li>
<li><p>拥塞窗口是动态的, 通过调节cwnd的值，发送方因此能调整它向连接发送数据的速率</p>
</li>
<li><p>发送方如何感知网络拥塞? </p>
<p>• 丢失事件 &#x3D; 超时<em>或者</em> 3个重复ACK</p>
<p>• 发生丢失事件后，TCP发送方降低速率(拥塞窗口) </p>
<p>• 正常时增加发送速率，自计时</p>
</li>
<li><p>TCP发送方怎样确定它应当发送的速率呢?</p>
<ol>
<li>一个丢失的报文段意味着拥塞，应当降低TCP发送速率</li>
<li>当收到未确认报文段的确认到达时，能够增加发送方的速率</li>
<li>带宽探测</li>
</ol>
</li>
<li><p>TCP拥塞控制算法</p>
<ol>
<li>包括三个部分：慢启动，拥塞避免，快速恢复</li>
<li>慢启动和拥塞避免是TCP的强制部分，快速恢复是推荐部分，对TCP发送方并非是必需的</li>
<li>慢启动<ul>
<li>连接开始的时候, cwnd &#x3D; 1 MSS，并且每当传输报文段首次被确认就增加一个MSS</li>
<li>故开始以指数方式增加速率，直到产生丢失事件，或者达到某个阈值ssthresh</li>
<li>如何结束：<ol>
<li>超时指示的丢包事件：发送方将cwnd &#x3D; 1 MSS，ssthresh（慢启动阈值）&#x3D;cwnd&#x2F;2</li>
<li>与ssthresh值相关：当到达或超过ssthresh值时线性增长，TCP转移到拥塞避免模式</li>
<li>收到3个冗余确认后：TCP执行一种快速重传并进入快速恢复状态</li>
</ol>
</li>
</ul>
</li>
<li>拥塞避免<ul>
<li>一旦进入拥塞避免状态，CongWin的值大约是上次遇到拥塞时的一半，即距离阻塞可能并不遥远</li>
<li>每个RTT只将CongWin的值增加一个MSS</li>
<li>超时事件以后，迁移到慢启动状态：CongWin值设置为1 MSS，Ssthresh&#x3D; CongWin &#x2F;2 </li>
<li>收到3个冗余确认后: CongWin减半+3个MSS，Ssthresh&#x3D; CongWin &#x2F;2 ，进入快速恢复阶段</li>
</ul>
</li>
<li>快速恢复<ul>
<li>对于引起TCP进入快速恢复状态的缺失报文段，每收到一个冗余的ACK，CongWin的值增加一个MSS</li>
<li>最终，当对丢失的报文段的一个ACK到达时，TCP在降低 CongWin后进入拥塞避免状态，cwnd&#x3D;ssthresh</li>
<li>如果出现超时事件，迁移到慢启动状态</li>
</ul>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<h2 id="第四章、网络层"><a href="#第四章、网络层" class="headerlink" title="第四章、网络层"></a>第四章、网络层</h2><h3 id="4-1、概述"><a href="#4-1、概述" class="headerlink" title="4.1、概述"></a>4.1、概述</h3><ol>
<li><p>数据平面功能：每台路由器的功能。</p>
<p>控制平面功能：全网范围决定路由的功能</p>
</li>
<li><p>网络层提供的服务和功能</p>
<p>• 主机通信</p>
<p>• 虚电路和数据报</p>
<p>• 转发</p>
<p>• 选路</p>
</li>
<li><p><strong>网络层的功能：转发和路由选择</strong></p>
<ul>
<li><p><em>转发：</em>将分组从路由器的一个输入链路接口转移到一个合适的输出链路接口的本地动作</p>
</li>
<li><p><em>路由选择：</em>指分组从源到目的地的端到端路径的网络范围动作</p>
</li>
</ul>
</li>
<li><p><em>转发表：</em>每台路由器有一张</p>
</li>
<li><p>控制平面：SDN方法</p>
<ul>
<li>一个分离的（通常是远程的）控制器和路由器本地的控制代理 (local control agents，CAs) 交互</li>
</ul>
</li>
<li><p><strong>分组交换机：</strong>一台通用分组交换设备，根据分组首部值，从输入链路接口到输出链路接口传送分组</p>
<p><strong>链路层交换机：</strong>根据链路层字段值作转发决定的分组交换机</p>
<p><strong>路由器：</strong>根据网络层字段值作转发决定的分组交换机</p>
</li>
<li><p>网络层可能提供的服务：</p>
<ol>
<li>确保交付：确保分组到达目的地。</li>
<li>有序分组交付：按发送顺序到达。</li>
<li>具有时延上界的确保交付：主机到主机的时延。</li>
<li>确保最小带宽：当发送主机以低于特定比特率的速率发送比特，分组不会丢失，在一定时延到达。</li>
<li>确保最大时延抖动：发送方发送两个连续分组的时间间隔与接收到的间隔相同</li>
</ol>
</li>
<li><p>因特网的网络层提供单一服务，称为<strong>尽力而为</strong>服务</p>
</li>
</ol>
<h3 id="4-2、数据报网络"><a href="#4-2、数据报网络" class="headerlink" title="4.2、数据报网络"></a>4.2、数据报网络</h3><ol>
<li>数据报转发表<ul>
<li>转发表是由路由选择处理器计算和更新的或者转发表接收来自远程SDN控制器的内容</li>
<li>用目的地址前缀与转发表的前缀匹配</li>
<li>存在匹配：向对应链路转发</li>
<li>不存在匹配：选择“其他”项对应的链路转发</li>
<li>存在多个匹配：使用最长前缀匹配规则，即向与最长前缀匹配的链路接口转发分组</li>
<li>一个端系统发送给另一个端系统的一批分组可能在网络中<strong>选择不同的路径，到达的顺序可能不一致</strong></li>
</ul>
</li>
</ol>
<h3 id="4-3、路由器工作原理"><a href="#4-3、路由器工作原理" class="headerlink" title="4.3、路由器工作原理"></a>4.3、路由器工作原理</h3><ol>
<li><p>网络层<strong>转发</strong>功能：将分组从路由器的输入链路传送到适当的输出链路</p>
</li>
<li><p>路由器体系结构</p>
</li>
<li><p>输入端口功能</p>
<ol>
<li><p>第一个线路端接模块：将一条物理链路端接到路由器的物理层</p>
</li>
<li><p>第二个数据链路处理模块：实现路由器的数据链路层功能；</p>
</li>
<li><p>第三个查找与转发模块：实现查找与转发功能，以便分组通过路由器交换结构转发到适当的输出端口；</p>
</li>
</ol>
</li>
<li><p>查（转发）表方法：</p>
<ol>
<li>线性查找</li>
<li>二分查找</li>
<li><em>三态内容可寻址内存(TCAM)</em></li>
<li><em>将最近被访问的表项保存在高速缓存(cache)中</em></li>
</ol>
</li>
<li><p><strong>交换结构</strong></p>
<ol>
<li><p>三种交换技术：经内存交换，经总线交换，经互联网络交换</p>
</li>
<li><p>经内存交换：</p>
<ul>
<li>输入端口与输出端口之间的交换由CPU(选路处理器)控制完成</li>
</ul>
</li>
<li><p>经总线交换：</p>
<ul>
<li>输入端口通过一条共享总线将分组直接传送到输出端口，不需要选路处理器的干预</li>
</ul>
</li>
</ol>
<ul>
<li>每次只能有一个分组通过总线传送</li>
</ul>
<ol start="4">
<li><p>经互联网络交换：</p>
<ul>
<li><p><em>纵横式交换机：</em>由2<em>n</em> 条总线组成，<em>n</em> 个输入端口与<em>n</em> 个输出端口连接</p>
</li>
<li><p>到达输入端口的分组沿水平总线穿行，直至与所希望的输出端口的垂直总线交叉点：</p>
</li>
</ul>
<p>  • 若该条垂直总线空闲，则分组被传送到输出端口；</p>
<p>  • 否则，该到达的分组被阻塞，必须在输入端口排队</p>
</li>
</ol>
</li>
<li><p>输出端口（Output ports）</p>
<ol>
<li>取出存放在输出端口内存中的分组，并将其传输到输出链路上</li>
<li>当输出端口的缓冲区溢出时，就会出现延时和丢包</li>
</ol>
</li>
<li><p>输入端口排队</p>
<ul>
<li><em>线路前部 HOL (head-of-the-line)阻塞：</em>输入队列中后面的分组被位于线路头的一个分组阻塞(即使输出端口空闲的)，等待通过交换结构发送</li>
</ul>
</li>
<li><p>输出端口排队</p>
<ul>
<li>分组丢弃方法：<ol>
<li>丢弃后到的分组（<em>弃尾</em>）</li>
<li>删除一个或多个已排队的分组</li>
</ol>
</li>
<li>少量TCP流：缓存数量（B）应当等于平均往返时延（RTT）乘以链路的容量（C）</li>
<li>大量TCP流（N条）：$B&#x3D;RTT*C&#x2F; \surd{N}$</li>
</ul>
</li>
<li><p><strong>分组调度</strong></p>
<ol>
<li><em>先来先服务FCFS</em>：简单</li>
<li><em>优先权排队</em>：具有优先级<ul>
<li>根据到达分组的类型，引导到不同优先级的队列中</li>
<li>优先发送具有最高优先级队列中的分组</li>
</ul>
</li>
<li><em>循环队列规则 RR</em><ul>
<li>根据到达分组的类型，引导到不同类别的队列中</li>
<li>循环调度器在这些不同类所对应的队列中轮流提供服务</li>
</ul>
</li>
<li><em>加权公平排队WFQ：</em>在具有排队分组的不同端到端连接之间公平地共享输出链路<ul>
<li>但是不同类的队列，在每个循环周期中，所获得的服务量并不平等，而是由其权值决定</li>
</ul>
</li>
</ol>
</li>
</ol>
<h3 id="4-4、网际协议（IPv4，DHCP，NAT）"><a href="#4-4、网际协议（IPv4，DHCP，NAT）" class="headerlink" title="4.4、网际协议（IPv4，DHCP，NAT）"></a>4.4、网际协议（IPv4，DHCP，NAT）</h3><ol>
<li><p>IPv4数据报格式</p>
<ol>
<li>一个 IP 数据报由首部和数据两部分组成</li>
<li>首部的前一部分是<strong>固定长度，共 20 字节，是所有 IP 数据报必须具有的</strong></li>
<li>在首部的固定部分的后面是一些可选字段，其长度是可变的</li>
<li>报文段：<ol>
<li>版本——占 4 位<ul>
<li>指 IP 协议的版本目前的 IP 协议版本号为 4 (即 IPv4)</li>
</ul>
</li>
<li>首部长度——占 4 位<ul>
<li>可表示的最大数值是 15 个单位(一个单位为 4 字节)</li>
<li>因此 IP 的首部长度的<strong>最大值是 60 字节</strong></li>
</ul>
</li>
<li>区分服务——占 8 位<ul>
<li>用来获得更好的服务在旧标准中叫做服务类型，一般不使用</li>
</ul>
</li>
<li>总长度——占 16 位<ul>
<li>指<strong>首部和数据之和</strong>的长度，单位为字节</li>
<li>因此数据报的最大长度为 65535 字节</li>
<li>总长度必须不超过最大传送单元 MTU</li>
</ul>
</li>
<li>标识(identification) 占 16 位<ul>
<li>它是一个计数器，用来产生数据报的标识</li>
</ul>
</li>
<li>标志(flag) 占 3 位<ul>
<li>目前只有前两位有意义</li>
<li>标志字段的最低位是 <strong>MF</strong> (More Fragment)，MF &#x3D; 1 表示后面“还有分片”。MF &#x3D; 0 表示最后一个分片。</li>
<li>标志字段中间的一位是 <strong>DF</strong> (Don’t Fragment) ，只有当 DF &#x3D; 0 时才允许分片</li>
</ul>
</li>
<li>片偏移(12 位)<ul>
<li>指出：较长的分组在分片后某片在原分组中的相对位置</li>
<li>片偏移以 8 个字节为偏移单位</li>
</ul>
</li>
<li>生存时间(8 位)记为 TTL (Time To Live)<ul>
<li>数据报在网络中可通过的路由器数的最大值</li>
<li>值为0则丢弃该数据报</li>
</ul>
</li>
<li>协议(8 位)字段<ul>
<li>指出此数据报携带的数据用于何种协议，以便目的主机的 IP 层将数据部分上交给哪个处理过程</li>
</ul>
</li>
<li>首部检验和(16 位)字段<ul>
<li><strong>只检验数据报的首部，不检验数据部分</strong></li>
<li>这里不采用 CRC 检验码而采用简单的计算方法</li>
</ul>
</li>
<li>源地址和目的地址都各占 4 字节</li>
<li>选项字段的长度可变，从 1 个字节到 40 个字节不等，取决于所选择的项目</li>
</ol>
</li>
</ol>
</li>
<li><p>IP数据报<strong>分片</strong>和重组</p>
<ol>
<li><p><strong>MTU</strong>指的是数据链路帧的数据区的最大字节数</p>
</li>
<li><p>在添加源地址和目的地址时，还会为该报文段，添加标识字段， 分片后的每个片，都具有相同的源地址和目的地址，以及相同的标识</p>
</li>
<li><p>MF&#x3D;0，表示最后一个片</p>
</li>
<li><p>通过片偏移字段，标识该片在初始IP数据报中的哪个位置</p>
<p><strong>注意：</strong>4000数据段字节大小包含数据3980字节和20字节首部</p>
</li>
</ol>
</li>
<li><p>IP地址</p>
<ol>
<li>IP 地址: 分配给主机或路由器接口的标识符</li>
<li>接口: 主机&#x2F;路由器与物理链路之间的边界<ul>
<li>路由器有多个接口</li>
<li>主机可以有多个接口</li>
<li>每个接口有一个IP地址</li>
</ul>
</li>
<li>IPV4：32个二进制位长（4字节），常用点分十进制表示</li>
<li>IPV6：128个二进制位长（16字节），常用冒号分隔表示</li>
</ol>
</li>
<li><p>IPv4编址</p>
<ol>
<li>32比特的二进制表示和点分十进制表示法</li>
</ol>
</li>
<li><p>IP地址结构</p>
<ol>
<li>IP 地址是一种分等级的地址结构，包括两部分：</li>
</ol>
<ul>
<li>网络号：指明主机所在网络的编号</li>
<li>主机号：主机在网络中的编号</li>
<li><strong>主机号为全0和全1的两个地址不能使用，用于特殊的目的！</strong></li>
</ul>
<ol start="2">
<li><p>好处：</p>
<ol>
<li>IP 地址管理机构在分配 IP 地址时只分配网络号</li>
<li>路由器仅根据目的主机所连接的网络号来转发分组</li>
</ol>
</li>
<li><p>特殊IP地址段：</p>
<ol>
<li><p>0.0.0.0</p>
<p>这个地址严格上来说都不是真正意义上的IP地址。主要是用来标识不清楚的网络和主机的。系统遇到无法识别的网络或主机的时候会统一的归纳到这个地址</p>
</li>
<li><p>255.255.255.255</p>
<p>这个地址是受限的广播地址。主要指一个网段内的所有主机</p>
</li>
<li><p>127.0.0.1</p>
<p>这个是预留的一个IP地址，主要是用来识别电脑自己本身的地址。也叫做“localhost”一般用来测试使用的</p>
</li>
</ol>
</li>
<li><p>同一局域网上的主机或路由器的IP地址中的网络号必须相同。用IP术语来说，<strong>具有相同网络号的局域网，称为子网</strong></p>
</li>
<li><p>路由器总是具有两个或两个以上IP地址</p>
</li>
<li><p>子网：</p>
<ul>
<li>设备接口的IP地址具有同样的网络部分</li>
<li>没有路由器的介入，物理上能够相互到达</li>
<li><strong>分开主机和路由器的每个接口，产生几个隔离的网络岛，使用接口端接这些隔离的网络的端点。这些隔离的网络中的每一个都叫做一个子网</strong></li>
</ul>
</li>
</ol>
</li>
<li><p>无类别域间路由( Classless Inlerdomain Routing,CIDR )</p>
<ol>
<li>因特网的地址分配策略称为CIDR</li>
<li>使用斜线记法，又称为CIDR记法来区分<strong>网络前缀和主机号</strong>，即在IP地址后面加上一个斜线“&#x2F;”，斜线后面用一个数字指定网络前缀的长度</li>
<li>地址格式: a.b.c.d&#x2F;x, 这里 x 是地址网络部分的bit数</li>
<li>其中&#x2F;x 的记法，也称为<strong>子网掩码</strong></li>
</ol>
</li>
<li><p><strong>子网掩码</strong></p>
<ol>
<li>子网掩码用来确定网络前缀和主机地址的长度</li>
<li>子网掩码长为32位比特，其中的1对应于IP地址中的网络号，而子网掩码中的0对应于主机号</li>
</ol>
</li>
<li><p>路由聚合：<strong>使用单个网路前缀通告多个网络的能力通常称为</strong>地址聚合，也称为路由聚合（书P220）</p>
</li>
<li><p><em><strong>子网划分！！！</strong></em></p>
<p><strong>子网划分总结：</strong></p>
<ul>
<li>对于子网划分，建议<strong>先把主机数量最多的子网划分了</strong>，再划分主机数量较小的子网。</li>
<li>对于子网划分，一个子网能使用的IP的范围，其<strong>起始IP一定是奇数</strong>、其<strong>截止的IP一定是一个偶数</strong></li>
<li>两个主机号相邻的子网，小序号子网的截止IP和大序号子网的起始IP，中间的差值为3，因为其间间隔了两个主机号为全1和全0的IP</li>
<li>对于网络号的表示，用于主机的所有bit都要为0</li>
</ul>
</li>
<li><p><strong>动态主机配置协议DHCP（Dynamic Host Configuration Protocol）</strong></p>
<ol>
<li><p>自动从一个DHCP服务器得到IP地址</p>
</li>
<li><p><strong>DHCP是应用层协议</strong></p>
</li>
<li><p>DHCP分配的不仅仅是IP地址，还可分配：</p>
<p>• 客户的第一跳路由器的地址（网关）</p>
<p>• DNS服务器的IP地址或域名</p>
<p>• 子网掩码</p>
</li>
<li><p>又被称为plug-and-play（即插即用）协议或zeroconf（零配置）协议</p>
</li>
<li><p>DHCP概述：</p>
<ul>
<li>主机广播 <strong>DHCP发现报文</strong>，在UDP分组中向端口67发送该报文，使用广播地址255.255.255.255，本机源IP地址0.0.0.0</li>
<li>DHCP 服务器广播<strong>DHCP提供报文</strong></li>
<li>主机从一个或多个服务器中选择一个并发送<strong>DHCP请求报文</strong>进行响应</li>
<li>DHCP 服务器用<strong>DHCP ACK报文</strong>回应确认</li>
<li>DHCP 终止租用期，发送DHCP RELEASE报文</li>
</ul>
</li>
<li><p>DHCP中继代理(relay agent)：通常为一台路由器</p>
<ul>
<li>当 DHCP 中继代理收到主机发送的发现报文后，就以单播方式向 DHCP 服务器转发此报文，并等待其回答。收到 DHCP 服务器回答的提供报文后，DHCP 中继代理再将此提供报文发回给主机</li>
</ul>
</li>
</ol>
</li>
<li><p>ISP获取地址块方法——从ICANN获取</p>
</li>
<li><p><strong>NAT：网络地址转换</strong></p>
<ol>
<li>动机: 对外部网络来讲，本地网络只用一个IP地址</li>
<li>在NAT转换表中，记录了每个(源IP 地址, 端口号)到 (NAT IP地址, 新端口号) 的对应关系</li>
<li>16-bit 端口号</li>
</ol>
</li>
<li><p>ICMP(Internet Control Message Protocol，因特网控制报文协议）PPT第四章P146，书P272</p>
<ol>
<li>用于主机路由器之间彼此交流网络层信息：<ul>
<li>差错报告: 不可到达的主机, 网络,端口,协议</li>
<li>请求&#x2F;应答 (用于ping,traceroute)</li>
</ul>
</li>
<li>位于IP之上：因为ICMP消息是装载在IP分组里的</li>
</ol>
</li>
</ol>
<h3 id="4-5、IPv6"><a href="#4-5、IPv6" class="headerlink" title="4.5、IPv6"></a>4.5、IPv6</h3><ol>
<li><p>IPv6首部：</p>
<ol>
<li>流量类型:表示流中分组的优先级,类似IPv4中的TOS字段，可用于给出给出一个流中某些数据的优先级</li>
<li>流标签: 表示分组在同一个 “流”中 (“流”的概念尚未完全定义)</li>
<li>下一个首部: 表示数据的上层协议，类似IPv4中的协议字段</li>
<li><strong>定长40字节首部</strong>，选项字段可能出现在“下一个首部”指出的位置上</li>
</ol>
</li>
<li><p>IPv6地址表示：</p>
<ol>
<li>冒号十六进制表示法</li>
</ol>
<ul>
<li><p>例如：</p>
<p>105.220.136.100.255.255.255.255.0.0.18.128.140.10.255.255</p>
<p>用冒号十六进制表示为：</p>
<p><strong>69DC:8864:FFFF:FFFF:0:1280:8C0A:FFFF</strong></p>
</li>
</ul>
<ol start="2">
<li><p>零压缩表示法</p>
<ul>
<li><p>每一块多个前导的0可以省略，一个块全为0可以简写为一个0,多个块为连续0的话可以简写为::</p>
<p>例如：FF0C:0:0:0:0:0:B1</p>
<p>零压缩表示为：</p>
<p><strong>FF0C::B1</strong></p>
</li>
</ul>
</li>
<li><p>IPv6分为三种地址类型：</p>
<ol>
<li>单播地址：一个单播地址对应一个接口，发往单播地址的数据包会被对应的接口接收</li>
<li>多播(组播)地址：一个组播地址对应一组接口，发往组播地址的数据包会被这组的所有接口接收；目的地为多个主机的数据包在特殊的多播地址上发送</li>
<li>任播地址：一个任播地址对应一组接口，发往任播地址的数据包会被这组接口的其中一个接收，被哪个接口接收由具体的路由协议确定</li>
<li><strong>IPv6不使用广播地址，广播地址的功能由多播地址代替</strong></li>
</ol>
</li>
</ol>
</li>
<li><p>IPv6与IPv4的不同</p>
<ol>
<li><p>分片与重新组装：IPv6 不允许在中间路由器上进行分片与重新组装</p>
</li>
<li><p>校验和: 全部去掉，减少每一跳的处理时间</p>
</li>
<li><p>选项: 允许, 但是不是标准首部的一部分，而是用下一个首部域指出</p>
</li>
<li><p>ICMPv6:新版本的 ICMP</p>
<p>• 增加消息类型, 例如“分组太大”</p>
<p>• 多播组管理功能</p>
</li>
</ol>
</li>
<li><p>IPv4到IPv6的过渡</p>
<ul>
<li>双栈：一些路由器具有双重栈 (v6, v4) 能够在两种格式中转换</li>
<li>隧道: 在穿过IPv4路由器时，IPv6分组作为 IPv4分组的负载</li>
</ul>
</li>
</ol>
<h3 id="4-6、路由选择算法"><a href="#4-6、路由选择算法" class="headerlink" title="4.6、路由选择算法"></a>4.6、路由选择算法</h3><ol>
<li>默认路由器：与主机直接相连的路由器，又叫第一跳路由器</li>
<li><strong>路由算法</strong>：是确定一个分组从源路由器到目的路由器所经路径的算法</li>
<li>路由算法分类：<ol>
<li>集中式（全局）选路算法，分散式路由选择算法</li>
<li>静态选路算法，动态选路算法</li>
</ol>
</li>
<li><em><strong>链路状态路由选择算法！！！</strong></em><ol>
<li>转发表：存放从源节点到每个目的节点的最低费用路径上的下一跳节点</li>
<li>所有迭代中需要搜寻的节点总数为n(n+1)&#x2F;2</li>
<li>算法复杂性为n平方阶序O(n^2^)</li>
</ol>
</li>
</ol>
<h3 id="4-7、层次选路"><a href="#4-7、层次选路" class="headerlink" title="4.7、层次选路"></a>4.7、层次选路</h3><ol>
<li><p><em>自治系统(Autonomous System) AS：</em> </p>
<ul>
<li>按区域划分的系统。每个AS由一组在相同管理控制下的路由器组成。</li>
<li>同一个AS内的路由器可运行相同的选路算法，且拥有相互之间的信息</li>
</ul>
</li>
<li><p>层次选路：</p>
<p>➢将一个大的系统划分成若干小系统（自治系统），</p>
<p>➢按区域或自治系统的形式组织路由器。</p>
<p>➢自治系统之间再互连</p>
</li>
<li><p><em>网关路由器（gateway router）：</em>互连各AS，负责转发目的地在本AS之外的分组（将本AS内的分组转发到另一个AS的路由器）</p>
</li>
<li><p>当一个AS知道从一个相邻的AS可以到达目的地，向某些他的相邻AS通告该选路信息</p>
</li>
<li><p>因特网中的路由选择</p>
<ol>
<li><p>AS内部选路协议：</p>
<p>✓ <em>RIP选路信息协议：</em>基于距离向量的路由协议</p>
<p>✓ <em>OSPF开放最短路径优先：</em>采用Dijkstra最短费用路径算法，是一种链路状态协议</p>
</li>
<li><p>AS间选路协议：</p>
<p>✓ <em>BGP边界网关协议：</em>基于距离向量的路由协议。相邻BGP路由器相互交换路径信息</p>
</li>
</ol>
</li>
<li><p><strong>OSPF</strong></p>
<ol>
<li>用链路状态算法</li>
<li>每个router都以洪泛的方式广播OSPF通告，OSPF通告里为每个邻居路由器设一个表项</li>
<li>通告会散布到整个自治系统</li>
<li><strong>OSPF信息直接通过 IP传输 (不是 TCP 或 UDP）</strong></li>
<li>优点：<ol>
<li>安全</li>
<li>多条相同开销的路径</li>
<li>对单播与多播路由选择的综合支持</li>
<li>支持在单个AS中的层次结构</li>
</ol>
</li>
</ol>
</li>
<li><p><strong>Internet 域间选路: 边界网关协议BGP</strong></p>
<ol>
<li><p>BGP (Border Gateway Protocol)：事实上的标准</p>
</li>
<li><p>路由器对（BGP对等方）通过<strong>TCP连接</strong>来交换选路信息：BGP 会话</p>
</li>
<li><p><strong>在BGP中，目的地不是主机地址，而是CIDR化前缀</strong></p>
</li>
<li><p>eBGP：跨越两个AS的BGP连接</p>
</li>
<li><p>iBGP：在相同AS中的两台路由器之间的BGP会话</p>
</li>
<li><p>确定最好的路由：</p>
<ol>
<li>AS-PATH: 包含了前缀的通告已经通告过的那些AS</li>
<li>NEXT-HOP: AS-PATH起始的路由器接口的IP地址（可能存在多条从当前AS到达下一个AS的链路）</li>
</ol>
</li>
<li><p>BGP路由选择：</p>
<p>排除规则（应用排除规则直到有一条留下）</p>
<p>• 本地偏好值属性: 具有最高偏好值的路由被选择</p>
<p>• 最短AS-PATH的路由 （使用AS跳数）</p>
<p>• 最靠近 NEXT-HOP路由器的路由 : 热土豆路由（AS内部路由算</p>
<p>法决定）。</p>
<p>• 其他标准</p>
</li>
<li><p>IP任播</p>
<ol>
<li>BGP还常被用于实现IP任播（ anycast ） 服务</li>
<li>所谓任播，也叫“选播”，就是对具有相同IP地址的一组服务器中的任意一台，发送消息</li>
</ol>
</li>
<li><p>为什么AS内选路和AS间选路采用不同的协议 ? </p>
<p>策略: </p>
<p>• AS间: 管理员想控制本AS内产生的通信流怎样选路，以及什么通信流穿过自己的网络</p>
<p>• AS内:单个管理者, 因此不需要策略</p>
</li>
</ol>
</li>
</ol>
<h3 id="4-8、SDN"><a href="#4-8、SDN" class="headerlink" title="4.8、SDN"></a>4.8、SDN</h3><ol>
<li><p>软件定义网络（SDN，SoftwareDefinedNetwork）源自美国斯坦福大学CLeanState研究组提出的一种新型网络创新架构，可通过软件编程的形式定义和控制网络，具有控制平面和转发平面分离及开放性可编程的特点</p>
</li>
<li><p>SDN的核心思想是建立一个通用转发体系——每个交换设备包含一个<strong>流表(flow table)</strong>.。流表由一个逻辑上中心化的控制器（远程控制器）来计算和分发 </p>
</li>
<li><p>基于目的转发的两个步骤：<strong>匹配+动作</strong></p>
</li>
<li><p>通用转发：通用意义上的匹配加动作</p>
<p>➢ 匹配：根据协议中多个首部中的字段进行匹配。 </p>
<p>➢ 动作：包括转发、丢弃、修改、负载均衡、向特定服务器转发等不同动作</p>
</li>
<li><p>SDN体系特征</p>
<ol>
<li>基于流的转发</li>
<li>数据平面与控制平面分离</li>
<li>网络控制功能：位于数据平面交换机外部</li>
<li>可编程的网络</li>
</ol>
</li>
<li><p>OpenFlow</p>
<ol>
<li>OpenFlow网络由 OpenFlow网络设备（OpenFlow Switch）和控制器（OpenFlow Controller）通过OpenFlow通道（OpenFlow Channel）组成</li>
</ol>
</li>
</ol>
<h2 id="第五章、链路层"><a href="#第五章、链路层" class="headerlink" title="第五章、链路层"></a>第五章、链路层</h2><h3 id="5-1、概述"><a href="#5-1、概述" class="headerlink" title="5.1、概述"></a>5.1、概述</h3><ol>
<li><em>节点 (node)：</em>主机、交换机和路由器、WiFi接入点等</li>
<li><em>链路(link)：</em>连接相邻节点的通信信道</li>
<li>数据链路层的职责：将分组通过一个链路，从一个节点传输到临近的另一个节点</li>
<li>交换的数据单元称为*帧 (frame)*，封装了一个网络层的数据报</li>
<li>链路层提供的服务<ol>
<li><strong>封装成帧 (framing)</strong></li>
<li><strong>链路访问</strong></li>
<li><strong>在相邻节点之间可靠交付</strong></li>
<li><strong>差错检查(error detection)</strong></li>
<li><strong>错误纠正(error correction)</strong></li>
<li><strong>流量控制(flow control)</strong></li>
</ol>
</li>
</ol>
<h3 id="5-2、差错检测与纠正"><a href="#5-2、差错检测与纠正" class="headerlink" title="5.2、差错检测与纠正"></a>5.2、差错检测与纠正</h3><ol>
<li>三种主要差错检测技术<ol>
<li><strong>奇偶校验</strong>：最基本的方法</li>
<li><strong>Internet校验和</strong>：常用于运输层</li>
<li><strong>循环冗余检测</strong>：常用于链路层</li>
</ol>
</li>
<li>奇偶校验<ol>
<li>一比特奇偶校验<ul>
<li>偶校验：发现奇数个“1”，至少有一个比特发生差错（奇数个比特差错）</li>
<li>奇校验：发现偶数个“1”，至少有一个比特发生差错</li>
<li>可以查出任意奇数个错误，但不能发现偶数个错误</li>
</ul>
</li>
<li>二维奇偶校验<ul>
<li>可以检测并纠正单个比特差错（数据或校验位中）</li>
<li>能够检测(但不能纠正)分组中任意两个比特的差错</li>
</ul>
</li>
</ol>
</li>
<li>循环冗余检测<strong>CRC (cyclic redundancy check)</strong><ol>
<li>特点：能检测小于 r+1 位的突发差错、任何奇数个差错，长度大于r+1比特的突发差错以概率 1 -0. 5^r^ 被检测到</li>
</ol>
</li>
</ol>
<h3 id="5-3、多路访问链路和协议"><a href="#5-3、多路访问链路和协议" class="headerlink" title="5.3、多路访问链路和协议"></a>5.3、多路访问链路和协议</h3><ol>
<li><p>两种访问链路：</p>
<ol>
<li>点对点链路：链路两端各一个节点。一个发送和一个接收。如点对点协议PPP</li>
<li>广播链路： 多个节点连接到一个共享的广播信道</li>
</ol>
</li>
<li><p>冲突（collide）：两个以上的节点同时传输帧，使接收方收不到正确的帧（所有冲突的帧都受损丢失）</p>
</li>
<li><p>三类多路访问协议：</p>
<ol>
<li>信道划分协议<ul>
<li>把信道划分为小“片” (时隙) </li>
<li>给节点分配专用的小“片”</li>
</ul>
</li>
<li>随机访问协议<ul>
<li>不划分信道，允许冲突</li>
<li>能从冲突中“恢复”</li>
</ul>
</li>
<li>轮流协议<ul>
<li>通过轮流访问信道避免冲突，要发送的节点越多轮流时间越长</li>
</ul>
</li>
</ol>
</li>
<li><p>信道划分协议</p>
<ol>
<li>主要有TDMA、FDMA、CDMA三种</li>
<li>时分多路访问TDMA (time division multiple access)<ul>
<li>将时间划分为<em>时间帧</em>，每个时间帧再划分为<em>N个时隙</em>（长度保证发送一个分组），分别分配给<em>N</em>个节点。每个节点只在固定分配的时隙中传输</li>
</ul>
</li>
<li>频分多路访问FDMA (frequency division multiple access)<ul>
<li>将总信道带宽 R b&#x2F;s划分为 N 个较小信道（频段，带宽为R&#x2F;N），分别分配给N 个节点</li>
</ul>
</li>
<li>码分多路访问CDMA (frequency division multiple access)<ul>
<li>每个节点分配一个唯一的编码</li>
<li>每个节点用它唯一的编码来对它发送的数据进行编码</li>
<li>允许多个节点“共存” ，信号可叠加，即可以同时传输数据而无冲突</li>
</ul>
</li>
</ol>
</li>
<li><p>随机访问协议</p>
<ol>
<li><p>ALOHA</p>
<ol>
<li><p>时隙ALOHA</p>
<ul>
<li>当节点有新的帧要发送，需等到下一个时隙开始，才传输整个帧</li>
<li><em>无冲突：</em>节点成功传输帧</li>
<li><em>有冲突：</em>节点检测到冲突后，以概率<em>p</em>在后续的每一个时隙重传该帧，直到成功</li>
</ul>
</li>
<li><p>纯 ALOHA</p>
<ul>
<li><p>帧一到达，立即传输</p>
</li>
<li><p>如果与其他帧产生冲突，在该冲突帧传完之后：</p>
<p>• 以概率<em>p</em>立即重传该帧；</p>
<p>• 或等待一个帧的传输时间，再以概率<em>p</em> 传输该帧，或者以概率1-<em>p</em> 等待另一个帧的时间</p>
</li>
</ul>
</li>
</ol>
</li>
<li><p>CSMA（载波侦听多路访问）</p>
<ol>
<li><strong>载波侦听</strong>：某个节点在发送之前，先监听信道</li>
</ol>
</li>
<li><p>带冲突检测的CSMA(CSMA&#x2F;CD)</p>
<ol>
<li><p>增加“载波侦听”和“冲突检测”两个规则</p>
</li>
<li><p>基本原理： 传送前侦听</p>
<p>• 信道忙：延迟传送</p>
<p>• 信道闲：传送整个帧</p>
</li>
<li><p>发送同时进行冲突检测：一旦检测到冲突就立即停止传输， 尽快重发</p>
</li>
</ol>
</li>
</ol>
</li>
<li><p>轮流协议</p>
<ol>
<li>轮询(polling)协议<ul>
<li>主节点“邀请”从节点依次传送</li>
</ul>
</li>
<li>令牌传递(token passing)协议<ul>
<li>控制令牌顺序从一个节点传递到下一个节点</li>
</ul>
</li>
</ol>
</li>
<li><p><strong>多路访问控制协议的总结</strong></p>
<ol>
<li><strong>信道划分</strong>：时分，频分，码分</li>
<li><strong>随机接入：</strong><ul>
<li>ALOHA, S-ALOHA, CSMA, CSMA&#x2F;CD</li>
<li>载波侦听：在某些技术中容易实现(有线)，在有些技术中比较困难(无线) </li>
<li>CSMA&#x2F;CD used in Ethernet</li>
<li>CSMA&#x2F;CA used in 802.11</li>
</ul>
</li>
<li><strong>轮流</strong><ul>
<li>来自中心站的轮询</li>
<li>令牌传递</li>
</ul>
</li>
</ol>
</li>
</ol>
<h3 id="5-4、交换局域网（ARP）"><a href="#5-4、交换局域网（ARP）" class="headerlink" title="5.4、交换局域网（ARP）"></a>5.4、交换局域网（ARP）</h3><ol>
<li><p>局域网：Local Area Network ( LAN )</p>
</li>
<li><p><strong>多址访问协议</strong>广泛应用于局域网</p>
</li>
<li><p>局域网按拓扑结构进行分类：星形网、环形网、总线网、树形网和网状网</p>
</li>
<li><p>基于<strong>随机访问的CSMA&#x2F;CD</strong>广泛应用于局域网</p>
</li>
<li><p><strong>链路层寻址和ARP</strong></p>
<ol>
<li><p>每个接口有网络层地址和链路层地址</p>
</li>
<li><p>链路层地址：MAC地址，用于把数据帧从一个节点传送到另一个节点(同一网络中)</p>
</li>
<li><p><strong>MAC地址</strong></p>
<ol>
<li>节点“网卡”本身所带的地址（唯一）</li>
<li><strong>MAC地址长度通常为6字节(48比特)，共2^48^个。 1A-2F-BB-76-09-AD</strong></li>
<li>6字节地址用16进制表示，每个字节表示为一对16进制数</li>
<li>网卡的MAC地址是永久的</li>
<li><strong>MAC 地址是平面（扁平）结构</strong>带有同一网卡的节点，在任何网络中都有同样的MAC地址</li>
</ol>
</li>
<li><p>MAC地址识别</p>
<ol>
<li>广播信道的局域网中，一个节点发送的帧，在信道上广播传输，其他节点都可能收到该帧</li>
<li><strong>发送适配器</strong>：将目的MAC地址封装到帧中，并发送。所有其他适配器都会收到这个帧</li>
<li><strong>接收适配器</strong>：检查帧的目的MAC地址是否与自己MAC地址相匹配：<ul>
<li>匹配：接收该帧，取出数据报，并传递给上层。</li>
<li>不匹配：丢弃该帧</li>
</ul>
</li>
<li><strong>广播帧：发送给所有节点的帧 。全1地址：FF-FF-FF-FF-FF-FF</strong></li>
</ol>
</li>
<li><p><strong>地址转换：主机名 → IP地址 → MAC地址</strong></p>
<ul>
<li><p>DNS域名系统：将主机名解析到IP地址。 </p>
<p>• DNS为在因特网中任何地方的主机解析主机名</p>
</li>
<li><p>ARP地址解析协议：将IP地址解析到MAC地址。 </p>
<p>• ARP只为在同一个LAN上的节点解析IP地址</p>
</li>
</ul>
</li>
</ol>
</li>
<li><p><strong>ARP：地址解析协议</strong></p>
<ol>
<li><p><em>ARP表:</em> 局域网上的每个节点(主机、路由器)都有这个表</p>
<ul>
<li>为某些局域网节点进行IP&#x2F;MAC地址映射：**&lt; IP address; MAC address; TTL&gt;**</li>
<li>TTL (存活时间): 地址映射将被删除的时间（通常为20分钟）</li>
</ul>
</li>
<li><p>查询过程：</p>
<p>A 希望发送数据报给 B 但B的MAC地址不在A的ARP映射表中</p>
<p>A广播包含B的IP地址的ARP查询分组 </p>
<p>​	• 目的MAC地址&#x3D; FF-FF-FF-FF-FF-FF</p>
<p>​	• 在局域网上的所有机器都能收到ARP查询</p>
<p>​	• 每个适配器把该帧中的ARP查询分组向上传递给ARP模块，并由ARP模块检查是否与查询IP匹配</p>
<p>B收到ARP分组，回给A一个带有B的MAC地址的分组 </p>
<p>​	• ARP响应分组单播发送给A的MAC地址</p>
</li>
<li><p><strong>ARP协议是跨越链路层和网络层两边的协议</strong></p>
</li>
</ol>
</li>
<li><p>以太网(Ethernet)</p>
<ol>
<li><p>到目前为止，以太网是最为著名的有线局域网技术</p>
</li>
<li><p>物理拓扑结构：星形(star)目前流行</p>
</li>
<li><p>以太网帧结构：</p>
<ol>
<li>前同步码（8字节）<ul>
<li>前7字节是“10101010”，最后一个字节是“10101011”。 </li>
<li>使接收方和发送方的时钟同步，接收方一旦收到连续的8字节前同步码，可确定有帧传过来。</li>
<li>前同步码是“无效信号”，接收方收到后删除，不向上层传。</li>
<li><strong>CRC的校验范围不包括前同步码</strong></li>
</ul>
</li>
<li>源、目的MAC地址(各6字节)</li>
<li>类型字段(2 字节)<ul>
<li>以太网可以“多路复用”（支持）多种网络层协议。通过“类型”字段区分</li>
</ul>
</li>
<li>数据字段(46～1500 字节)<ul>
<li><strong>以太网的最大传输单元MTU是1500字节</strong></li>
<li><strong>若IP数据报超过1500字节，必须将该数据报分片</strong></li>
<li>最小长度是46字节</li>
<li>如果IP数据报小于46字节，必须填充为46字节。接收方网络层去除填充内容</li>
</ul>
</li>
<li>循环冗余检测CRC(4字节)<ul>
<li>接收主机进行CRC校验：接收主机对收到的帧校验。若计算结果，<strong>余数不等于0</strong>(CRC校验失败)，该帧有差错</li>
</ul>
</li>
</ol>
</li>
</ol>
</li>
<li><p>CSMA&#x2F;CD:以太网的多路访问协议</p>
<ol>
<li><p><em>未使用时隙：</em>适配器可以在任何时刻开始传输</p>
</li>
<li><p><em>使用载波侦听：</em>当一个节点要发送数据时，首先监听信道，看是否有载波。</p>
<ul>
<li><p>如果信道空闲，则发送数据。</p>
</li>
<li><p>如果信道忙，则继续对信道进行监听（1－坚持CSMA）。一旦发现空闲，便立即发送</p>
</li>
</ul>
</li>
<li><p><em>使用冲突检测：</em>如果在发送过程中检测到碰撞，则停止自己的正常发送，转而发送一短暂的干扰信号jam，强化冲突，使其它站点都能知道出现了冲突</p>
</li>
<li><p><em>重传：</em>发送了干扰信号后，退避一随机时间，重新尝试发送</p>
</li>
<li><p><em>基本后退时间：</em>以512 比特时间为单位；</p>
<p>✓<em>第n次冲突后退让时间<strong>：</strong>K</em> × 512 比特时间</p>
<p><em>K</em>与冲突次数有关，是{ 0～2<em>m</em>-1}之间的一个随机整数。 <em>m &#x3D;</em> min(<em>n</em>，10)</p>
</li>
</ol>
</li>
<li><p>以太网向网络层提供的服务：</p>
<ol>
<li>无连接服务<ol start="2">
<li>不可靠的服务</li>
</ol>
</li>
<li>以太网的MAC协议：使用无时隙的CSMA&#x2F;CD协议</li>
</ol>
</li>
</ol>
<h3 id="5-5、链路层交换机"><a href="#5-5、链路层交换机" class="headerlink" title="5.5、链路层交换机"></a>5.5、链路层交换机</h3><ol>
<li><p><strong>集线器Hub</strong>：集线器本质上是物理层的中继器</p>
</li>
<li><p>互联网络中所有的网段属于同一个<em>冲突域</em></p>
</li>
<li><p>每个交换机有一个交换机转发表，其中每个条目：(主机的MAC地址，到达主机的端口，时戳)类似于路由表</p>
</li>
<li><p>通过自学习建立转发表中的条目</p>
</li>
<li><p><em>过滤(filtering)：</em>交换机判断一个帧是应该转发到某个接口还是丢弃</p>
</li>
<li><p><em>转发(forward)：</em>交换机决定一个帧应该被指向哪个接口，并引导到该接口</p>
</li>
<li><p>自学习：交换机会学习通过哪些端口可以到达哪些主机。即交换机表可以自动地、动态地和自主地建立</p>
</li>
<li><p><strong>交换机是即插即用设备 (plug-and-play device)</strong></p>
</li>
<li><p>路由器与交换机比较</p>
<ol>
<li>两者都是存储转发设备:<ul>
<li>路由器: 网络层设备(检查网络层头部)</li>
<li>交换机：链路层设备(检查链路层头部)</li>
</ul>
</li>
<li>两者都有转发表<ul>
<li>路由器：使用<strong>路由算法</strong>计算转发表，基于IP地址转发</li>
<li>交换机：通过<strong>洪泛、自学习</strong>来学习转发表，基于MAC地址转发</li>
</ul>
</li>
</ol>
</li>
<li><p>交换机优缺点：</p>
<ol>
<li><p>✓即插即用：不需网络管理员干预；</p>
<p>✓较高的分组过滤和转发率：</p>
<p>✓拓扑结构为一棵生成树。</p>
<p>✓可能产生“广播风暴”：</p>
<p>某台主机失控，并传输无穷的以太网广播帧流，交换机将转发所有这些帧，导致整个以太网的崩溃</p>
</li>
</ol>
</li>
</ol>
<h3 id="5-6、VLAN虚拟局域网"><a href="#5-6、VLAN虚拟局域网" class="headerlink" title="5.6、VLAN虚拟局域网"></a>5.6、VLAN虚拟局域网</h3><ol>
<li>支持VLAN的交换机允许经一个单一的物理局域网基础设施定义多个虚拟局域网</li>
<li>基于端口、MAC地址、IP地址、网络层协议等不同的方式划分 VLAN</li>
<li>基于端口的VLAN：<ol>
<li><em>流量隔离:</em> 来至端口1-8的流量，只能到达端口1-8 <ul>
<li>每个VLAN形成独立的广播域</li>
</ul>
</li>
<li>端口动态的分配: 一个端口可以由管理员动态的分配给一个VLAN，只需通过软件进行配置</li>
<li><strong>VLAN间的转发: 只能通过VLAN间的路由实现</strong><ul>
<li>在实践中厂商把交换机加路由器包含在一台设备中，就是所谓的三层交换机</li>
</ul>
</li>
<li><em>干线端口(trunk port):</em> 用于在多个物理交换机之间交换帧</li>
</ol>
</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://For-Melody.github.io">Melody</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://for-melody.github.io/2022/12/15/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">https://for-melody.github.io/2022/12/15/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://For-Melody.github.io" target="_blank">Melodyの博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://pictrue-bed.pages.dev/img/a78c8de3a671c5b31eff23ef4087b211.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2022/12/15/MySQL/"><img class="prev-cover" src="https://pictrue-bed.pages.dev/img/a78c8de3a671c5b31eff23ef4087b211.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MySQL</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://pictrue-bed.pages.dev/img/102548934_p0_master1200.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Melody</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/For-Melody"><i></i><span>🛴前往小家...</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/For-Melody" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:185943464@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><b><font color="#a591e0">📬：这里是Melody的博客，记录很多有意思的东西和思考的内容</font></b></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C"><span class="toc-number">1.</span> <span class="toc-text">计算机网络</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0%E3%80%81%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text">第一章、概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%81%E5%BA%94%E7%94%A8%E5%B1%82"><span class="toc-number">1.2.</span> <span class="toc-text">第二章、应用层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1%E3%80%81%E5%BA%94%E7%94%A8%E5%B1%82%E5%8D%8F%E8%AE%AE%E5%8E%9F%E7%90%86"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1、应用层协议原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2%E3%80%81Web%E5%92%8CHTTP"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2、Web和HTTP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3%E3%80%81%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3、电子邮件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4%E3%80%81DNS"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4、DNS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0%E3%80%81%E8%BF%90%E8%BE%93%E5%B1%82"><span class="toc-number">1.3.</span> <span class="toc-text">第三章、运输层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1%E3%80%81%E5%A4%9A%E8%B7%AF%E5%88%86%E8%A7%A3%E4%B8%8E%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1、多路分解与多路复用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2%E3%80%81UDP"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2、UDP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3%E3%80%81%E5%8F%AF%E9%9D%A0%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3、可靠数据传输协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4%E3%80%81TCP"><span class="toc-number">1.3.4.</span> <span class="toc-text">3.4、TCP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0%E3%80%81%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">1.4.</span> <span class="toc-text">第四章、网络层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1%E3%80%81%E6%A6%82%E8%BF%B0"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1、概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2%E3%80%81%E6%95%B0%E6%8D%AE%E6%8A%A5%E7%BD%91%E7%BB%9C"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2、数据报网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3%E3%80%81%E8%B7%AF%E7%94%B1%E5%99%A8%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3、路由器工作原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4%E3%80%81%E7%BD%91%E9%99%85%E5%8D%8F%E8%AE%AE%EF%BC%88IPv4%EF%BC%8CDHCP%EF%BC%8CNAT%EF%BC%89"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.4、网际协议（IPv4，DHCP，NAT）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5%E3%80%81IPv6"><span class="toc-number">1.4.5.</span> <span class="toc-text">4.5、IPv6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6%E3%80%81%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E7%AE%97%E6%B3%95"><span class="toc-number">1.4.6.</span> <span class="toc-text">4.6、路由选择算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7%E3%80%81%E5%B1%82%E6%AC%A1%E9%80%89%E8%B7%AF"><span class="toc-number">1.4.7.</span> <span class="toc-text">4.7、层次选路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-8%E3%80%81SDN"><span class="toc-number">1.4.8.</span> <span class="toc-text">4.8、SDN</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0%E3%80%81%E9%93%BE%E8%B7%AF%E5%B1%82"><span class="toc-number">1.5.</span> <span class="toc-text">第五章、链路层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1%E3%80%81%E6%A6%82%E8%BF%B0"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1、概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2%E3%80%81%E5%B7%AE%E9%94%99%E6%A3%80%E6%B5%8B%E4%B8%8E%E7%BA%A0%E6%AD%A3"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2、差错检测与纠正</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3%E3%80%81%E5%A4%9A%E8%B7%AF%E8%AE%BF%E9%97%AE%E9%93%BE%E8%B7%AF%E5%92%8C%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.5.3.</span> <span class="toc-text">5.3、多路访问链路和协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4%E3%80%81%E4%BA%A4%E6%8D%A2%E5%B1%80%E5%9F%9F%E7%BD%91%EF%BC%88ARP%EF%BC%89"><span class="toc-number">1.5.4.</span> <span class="toc-text">5.4、交换局域网（ARP）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5%E3%80%81%E9%93%BE%E8%B7%AF%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA"><span class="toc-number">1.5.5.</span> <span class="toc-text">5.5、链路层交换机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6%E3%80%81VLAN%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91"><span class="toc-number">1.5.6.</span> <span class="toc-text">5.6、VLAN虚拟局域网</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://pictrue-bed.pages.dev/img/a78c8de3a671c5b31eff23ef4087b211.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2022 By Melody</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hibiki.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body></html>